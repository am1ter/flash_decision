# Change python workdir
sys.path.extend(['C:\\!Coding\\flash_decision\\flash_backend', 'C:/!Coding/flash_decision/flash_backend'])

# Upgrade db with alembic
flask db upgrade

# Connect WSL to LAN (run with powershell)
ip addr show
netsh interface portproxy add v4tov4 listenport=8000 listenaddress=0.0.0.0 connectport=8000 connectaddress=172.17.221.129

# Remove docker images without names
docker rmi $(docker images -a | grep "^<none>" | awk '{print $3}')

# Install selenium requirements (chromedriver)
RUN apt-get install -y unzip xvfb libxi6 libgconf-2-4 default-jdk 
RUN curl -sS -o - https://dl-ssl.google.com/linux/linux_signing_key.pub | apt-key add 
RUN bash -c "echo 'deb [arch=amd64] http://dl.google.com/linux/chrome/deb/ stable main' >> /etc/apt/sources.list.d/google-chrome.list" 
RUN apt -y update 
RUN apt -y install google-chrome-stable 

# Alternative chrome driver installation
RUN wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
RUN dpkg -i google-chrome-stable_current_amd64.deb

# Prevent docker containter from exit
ENTRYPOINT ["tail", "-f", "/dev/null"]